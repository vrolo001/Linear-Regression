mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
mutate(mean_singles = mean(singles), mean_bb = mean(bb))
head(bat_99_01)
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb) %>%
mutate(mean_singles = mean(singles), mean_bb = mean(bb))
bat_99_01
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb) %>%
group_by(playerID) %>%
mutate(mean_singles = mean(singles), mean_bb = mean(bb))
head(bat_99_01)
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb) %>%
mutate(mean_singles = mean(singles), mean_bb = mean(bb))
head(bat_99_01)
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb))
head(bat_99_01)
sum(bat_99_01$mean_singles > 0.2)
sum(bat_99_01$mean_bb > 0.2)
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb))
head(bat_99_01)
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb)) %>%
ungroup()
bat_99_01
sum(bat_99_01$mean_singles > 0.2)
sum(bat_99_01$mean_bb > 0.2)
filter(mean_singles > 0.2) %>% nrow()
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb)) %>%
ungroup() %>%
filter(mean_singles > 0.2) %>% nrow()
bat_99_01
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb)) %>%
ungroup() %>%
bat_99_01
head(bat_99_01)
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb)) %>%
ungroup()
bat_99_01
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb)
head(bat_99_01)
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001)
bat_99_01
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb, yearID)
head(bat_99_01)
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb, yearID) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb))
head(bat_99_01)
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb, yearID) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb)) %>%
ungroup()
sum(bat_99_01$mean_singles > 0.2)
sum(bat_99_01$mean_bb > 0.2)
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb, yearID) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb))
sum(bat_99_01$mean_singles > 0.2)
sum(bat_99_01$mean_bb > 0.2)
bat_99_01 <- Batting %>%
filter(yearID == 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb, yearID) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb)) %>%
ungroup()
nrow(bat_99_01$mean_singles > 0.2)
head(bat_99_01)
bat_99_01 <- Batting %>%
filter(yearID %in% 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb, yearID) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb)) %>%
ungroup()
sum(bat_99_01$mean_singles > 0.2)
sum(bat_99_01$mean_bb > 0.2)
bat_99_01 <- Batting %>%
filter(yearID %in% 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb, yearID) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb)) %>%
sum(bat_99_01$mean_singles > 0.2)
sum(bat_99_01$mean_bb > 0.2)
bat_99_01 <- Batting %>%
filter(yearID %in% 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb, yearID) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb))
sum(bat_99_01$mean_singles > 0.2)
sum(bat_99_01$mean_bb > 0.2)
?inner_join
inner_join(bat_02, bat_99_01)
inner_join(bat_02, bat_99_01, by = yearID)
library(Lahman)
bat_02 <- Batting %>% filter(yearID == 2002) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb, yearID)
bat_99_01 <- Batting %>%
filter(yearID %in% 1999:2001) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb, yearID) %>%
group_by(playerID) %>%
summarize(mean_singles = mean(singles), mean_bb = mean(bb))
sum(bat_99_01$mean_singles > 0.2)
sum(bat_99_01$mean_bb > 0.2)
inner_join(bat_02, bat_99_01, by = yearID)
library(Lahman)
bat_02 <- Batting %>% filter(yearID == 2002) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb)
head(bat_02)
head(bat_99_01)
inner_join(bat_02, bat_99_01)
inner_join(bat_02, bat_99_01)
summarize (r = cor(singles, mean_singles))
inner_join(bat_02, bat_99_01) %>%
summarize (r = cor(singles, mean_singles))
inner_join(bat_02, bat_99_01) %>%
summarize (r_singles = cor(singles, mean_singles), r_bb = cor(bb, mean_bb))
ombined <- inner_join(bat_02, bat_99_01) %>%
summarize (r_singles = cor(singles, mean_singles), r_bb = cor(bb, mean_bb))
combined <- inner_join(bat_02, bat_99_01) %>%
summarize (r_singles = cor(singles, mean_singles), r_bb = cor(bb, mean_bb))
combined
inner_join(bat_02, bat_99_01)
inner_join(bat_02, bat_99_01) %>%
ggplot(aes(singles, mean_singles)) %>%
geom_point()
inner_join(bat_02, bat_99_01) %>%
ggplot(aes(singles, mean_singles)) +
geom_point(
inner_join(bat_02, bat_99_01) %>%
ggplot(aes(singles, mean_singles)) +
geom_point()
inner_join(bat_02, bat_99_01) %>%
ggplot(aes(singles, mean_singles)) +
geom_point()
inner_join(bat_02, bat_99_01)
inner_join(bat_02, bat_99_01) %>%
ggplot(aes(singles, mean_singles)) +
geom_point()
inner_join(bat_02, bat_99_01) %>%
ggplot(aes(bb, mean_bb)) +
geom_point()
inner_join(bat_02, bat_99_01) %>%
lm(singles ~ mean_singles, data = .)
inner_join(bat_02, bat_99_01) %>%
lm(bb ~ mean_bb, data = .)
data("Teams")
data(Teams)
head(Teams)
Teams
as_tibble(Teams)
class(Teams[,20])
class(as.tibble(Teams[,20]))
Teams$hr
as.tibble(Teams)$hr
dat<-Teams %>%
group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
dat
get_slope <- function(data) {
fit <- lm(R ~ BB, data = data)
sum.fit <- summary(fit)
data.frame(slope = sum.fit$coefficients[2, "Estimate"],
se = sum.fit$coefficients[2, "Std. Error"],
pvalue = sum.fit$coefficients[2, "Pr(>|t|)"])
}
get_slope
get_slope(dat)
get_slope(dat)
get_slope(dat)
dat<-Teams %>%
group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
get_slope <- function(data) {
fit <- lm(R ~ BB, data = data)
sum.fit <- summary(fit)
data.frame(slope = sum.fit$coefficients[2, "Estimate"],
se = sum.fit$coefficients[2, "Std. Error"],
pvalue = sum.fit$coefficients[2, "Pr(>|t|)"])
}
dat %>%
group_by(HR) %>%
do(slope = get_slope(.))
dat %>%
group_by(HR) %>%
do(get_slope)
dat %>%
group_by(HR) %>%
do(get_slope(.))
dat %>%
do(get_slope(.))
install.packages("broom")
install.packages("broom")
dat<-Teams %>%
group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
get_slope <- function(data) {
fit <- lm(R ~ BB, data = data)
sum.fit <- summary(fit)
data.frame(slope = sum.fit$coefficients[2, "Estimate"],
se = sum.fit$coefficients[2, "Std. Error"],
pvalue = sum.fit$coefficients[2, "Pr(>|t|)"])
dat %>%
group_by(HR) %>%
do(slope = get_slope(.))
dat<-Teams %>%
group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
get_slope <- function(data) {
fit <- lm(R ~ BB, data = data)
sum.fit <- summary(fit)
data.frame(slope = sum.fit$coefficients[2, "Estimate"],
se = sum.fit$coefficients[2, "Std. Error"],
pvalue = sum.fit$coefficients[2, "Pr(>|t|)"])
}
library(tidyverse)
library(dslabs)
library(HistData)
data("GaltonFamilies")
set.seed(1983)
galton_heights <- GaltonFamilies %>%
filter(gender == "male") %>%
group_by(family) %>%
sample_n(1) %>%
ungroup() %>%
select(father, childHeight) %>%
rename(son = childHeight)
dat<-Teams %>%
group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
get_slope <- function(data) {
fit <- lm(R ~ BB, data = data)
sum.fit <- summary(fit)
data.frame(slope = sum.fit$coefficients[2, "Estimate"],
se = sum.fit$coefficients[2, "Std. Error"],
pvalue = sum.fit$coefficients[2, "Pr(>|t|)"])
}
dat %>%
group_by(HR) %>%
do(slope = get_slope(.))
dat %>%
do(get_slope(.))
dat %>%
group_by(HR) %>%
do(get_slope(.))
dat %>%
group_by(HR) %>%
do(get_slope)
dat %>%
group_by(HR) %>%
do(slope = get_slope(.))
get_slope <- function(data) {
fit <- lm(R ~ BB, data = data)
sum.fit <- summary(fit)
data.frame(slope = sum.fit$coefficients[2, "Estimate"],
se = sum.fit$coefficients[2, "Std. Error"],
pvalue = sum.fit$coefficients[2, "Pr(>|t|)"])
dat<-Teams %>%
group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
dat %>%
group_by(HR) %>%
do(slope = get_slope(.))
dat %>%
group_by(HR) %>%
do(slope = get_slope(.))
dat %>%
group_by(HR) %>%
do(slope = get_slope(.))
library(broom)
dat<-Teams %>%
group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
get_slope <- function(data) {
fit <- lm(R ~ BB, data = data)
sum.fit <- summary(fit)
data.frame(slope = sum.fit$coefficients[2, "Estimate"],
se = sum.fit$coefficients[2, "Std. Error"],
pvalue = sum.fit$coefficients[2, "Pr(>|t|)"])
}
dat %>%
group_by(HR) %>%
do(slope = get_slope(.))
library(broom)
dat<-Teams %>%
group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
get_slope <- function(data) {
fit <- lm(R ~ BB, data = data)
sum.fit <- summary(fit)
data.frame(slope = sum.fit$coefficients[2, "Estimate"],
se = sum.fit$coefficients[2, "Std. Error"],
pvalue = sum.fit$coefficients[2, "Pr(>|t|)"])
}
dat %>%
group_by(HR) %>%
do(slope = get_slope(.))
dat %>%
do(get_slope(.))
dat %>%
group_by(HR) %>%
do(get_slope(.))
dat %>%
group_by(HR) %>%
do(get_slope)
dat %>%
group_by(HR) %>%
do(get_slope(.))
dat <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(HR = round(HR/G, 1),
BB = BB/G,
R = R/G) %>%
select(HR, BB, R) %>%
filter(HR >= 0.4 & HR<=1.2)
dat<- group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
at <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(HR = round(HR/G, 1),
BB = BB/G,
R = R/G) %>%
select(HR, BB, R) %>%
filter(HR >= 0.4 & HR<=1.2)
dat<- group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
dat<- group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
dat <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(HR = round(HR/G, 1),
BB = BB/G,
R = R/G) %>%
select(HR, BB, R) %>%
filter(HR >= 0.4 & HR<=1.2)
dat %>%
group_by(HR) %>%
do(fit = lm(R ~ BB, data = .))
get_slope <- function(data) {
fit <- lm(R ~ BB, data = data)
sum.fit <- summary(fit)
data.frame(slope = sum.fit$coefficients[2, "Estimate"],
se = sum.fit$coefficients[2, "Std. Error"],
pvalue = sum.fit$coefficients[2, "Pr(>|t|)"])
}
dat %>%
group_by(HR) %>%
do(get_slope(.))
dat <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(HR = HR/G,
R = R/G) %>%
select(lgID, HR, BB, R)
dat %>%
group_by(lgID) %>%
do(tidy(lm(R ~ HR, data = .), conf.int = T)) %>%
filter(term == "HR")
dat %>%
group_by(lgID) %>%
do(glance(lm(R ~ HR, data = .)))
dat %>%
do(tidy(lm(R ~ HR, data = .), conf.int = T)) %>%
filter(term == "HR")
dat %>%
group_by(lgID) %>%
do(mod = lm(R ~ HR, data = .))
library(tidyverse)
library(HistData)
data("GaltonFamilies")
set.seed(1, sample.kind = "Rounding")
galton <- GaltonFamilies %>%
group_by(family, gender) %>%
sample_n(1) %>%
ungroup() %>%
gather(parent, parentHeight, father:mother) %>%
mutate(child = ifelse(gender == "female", "daughter", "son")) %>%
unite(pair, c("parent", "child"))
head(galton)
galton %>%
group_by(pair)
galton %>%
group_by(pair) %>%
filter(pair == "father_daguther") %>%
nrow(pair)
galton %>%
group_by(pair) %>%
filter(pair == "father_daguther") %>%
nrow(galton)
galton %>%
group_by(pair) %>%
filter(pair == "father_daguther")
galton
galton %>%
group_by(pair)
galton %>%
group_by(pair) %>%
filter(pair == "father_daguther")
galton
galton %>%
group_by(pair) %>%
sum(pair == "father_daguther")
names(galton)
galton %>%
group_by(pair)
levels(galton$pair)
galtonfd %>%
filter(pair=="father_daughter")
galtonfd <- galton %>%
filter(pair=="father_daughter")
nrow(galtonfd)
galtonms <- galton %>%
filter(pair=="mother_son")
nrow(galtonms)
galton %>%
group_by(pair) %>%
summarize(r = cor(parentHeight, childHeight))
galton %>%
group_by(pair) %>%
do(tidy(lm(childHeight ~ parentHeight, data = .), conf.int = TRUE))
galton %>%
group_by(pair) %>%
do(tidy(lm(childHeight ~ parentHeight, data = .), conf.int = TRUE)) %>%
ggplot(aes(pair, y = estimate, ymin = conf.low, ymax = conf.high)) +
geom_errorbar() +
geom_point()
galton %>%
group_by(pair) %>%
do(tidy(lm(childHeight ~ parentHeight, data = .), conf.int = TRUE)) %>%
filter(term == "parentHeight") %>%
select (pair, estimate, std.error, p.value, conf.low, conf.high)
galton %>%
group_by(pair) %>%
do(tidy(lm(childHeight ~ parentHeight, data = .), conf.int = TRUE)) %>%
filter(term == "parentHeight") %>%
select (pair, estimate, std.error, p.value, conf.low, conf.high) %>%
ggplot(aes(pair, y = estimate, ymin = conf.low, ymax = conf.high)) +
geom_errorbar() +
geom_point()
